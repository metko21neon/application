<div class="im-capital">

  <table matSort mat-table multiTemplateDataRows [dataSource]="dataSource">
    <ng-container matColumnDef="asset">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Asset </th>

      <td mat-cell *matCellDef="let element">
        <a class="th-link" [routerLink]="['./', element?.id]"> {{ element?.target }} </a>
      </td>
    </ng-container>

    <ng-container matColumnDef="port">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Port </th>

      <td mat-cell *matCellDef="let element">
        {{ element?.port }}/{{ element?.protocol }}
      </td>
    </ng-container>

    <ng-container matColumnDef="service">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Service </th>

      <td mat-cell *matCellDef="let element"> {{ element?.service }} </td>
    </ng-container>

    <ng-container matColumnDef="date">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Date </th>

      <td mat-cell *matCellDef="let element"> {{ element?.checked_at | date: 'yyyy-MM-dd' }} </td>
    </ng-container>

    <ng-container matColumnDef="type">
      <th mat-header-cell *matHeaderCellDef> Type </th>

      <td mat-cell *matCellDef="let element"> {{ element?.type?.toLowerCase() }} </td>
    </ng-container>

    <ng-container matColumnDef="cve">
      <th mat-header-cell *matHeaderCellDef> CVE </th>

      <td mat-cell *matCellDef="let element"> {{ element?.cve_id }} </td>
    </ng-container>

    <ng-container matColumnDef="expanded_detail">
      <td mat-cell *matCellDef="let element" [attr.colspan]="columnList.length">
        <div [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
          <p style="width: 90%; padding: 10px 10px; color: #0009; font-size: 13px; margin: 0;">
            {{ element.description[0] }}
          </p>

          <div class="details-button-wrapper">
            <a class="th-link" [routerLink]="['./', element?.id]">
              Vulnerability Details
              <!-- <mat-icon>keyboard_arrow_right</mat-icon> -->
            </a>
          </div>
        </div>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="columnList"></tr>

    <tr mat-row *matRowDef="let element; columns: columnList;" [class.expanded-row]="expandedElement === element"
      (click)="expandedElement = expandedElement === element ? null : element">
    </tr>

    <tr mat-row class="details-row" *matRowDef="let row; columns: ['expanded_detail']"></tr>
  </table>
</div>