<div class="im-app">
  <h1 class="im-header"> {{ tokenDetails?.name }} {{ tokenDetails?.symbol }} </h1>

  <div class="im-content">
    <div> Rank: {{ tokenDetails?.rank }} </div>
    <div> Coin price: {{ tokenDetails?.price | currency: 'USD': 'symbol': '1.2-20' }} </div>
    <div> Average price: {{ tokenDetails?.averagePrice | currency: 'USD': 'symbol': '1.2-20' }} </div>

    <br>

    <div> Total coins: {{ wallet?.quantity }} {{ tokenDetails?.symbol }} </div>
    <div> Current spent usd: {{ wallet?.investedAmount }} USD </div>
    <div> Amount in currency: {{ wallet?.totalInCurrency | currency }} </div>
    <div> Currency result: {{ wallet?.currencyResult }} USD </div>
    <div> Percentage result: {{ wallet?.percentageResult }}% </div>

    <table matSort mat-table class="mat-elevation-z8 mt-15" style="width: 100%;" [dataSource]="dataSource">
      <ng-container matColumnDef="number">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> # </th>
        <td mat-cell *matCellDef="let index = index"> {{ index + 1 }} </td>
      </ng-container>

      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Action </th>
        <td mat-cell *matCellDef="let element"> {{ element.action | uppercase }} </td>
      </ng-container>

      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Price </th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="actionHistoryEnum.RECEIVE !== element.action && actionHistoryEnum.TRANSFER !== element.action">
            {{ (element?.price | currency: 'USD': 'symbol': '1.2-20') || '-' }}
          </span>

          <span *ngIf="actionHistoryEnum.RECEIVE === element.action || actionHistoryEnum.TRANSFER === element.action">
            {{ (element?.averagePrice | currency: 'USD': 'symbol': '1.2-20') }}
          </span>
        </td>
      </ng-container>

      <ng-container matColumnDef="total">
        <th mat-header-cell mat-sort-header *matHeaderCellDef> Total </th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="actionHistoryEnum.TRANSFER === element.action || actionHistoryEnum.RECEIVE === element.action">
            {{ element.amount * element.averagePrice }} USD
          </span>

          <span *ngIf="actionHistoryEnum.SELL === element.action" class="is-buy">
            {{ element.filled * element.price }} USD
          </span>

          <span *ngIf="actionHistoryEnum.BUY === element.action" class="is-sell">
            {{ element.total }} USD
          </span>
        </td>
      </ng-container>

      <ng-container matColumnDef="quantity">
        <th mat-header-cell mat-sort-header *matHeaderCellDef> Quantity </th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="actionHistoryEnum.TRANSFER === element.action" class="is-sell">
            - {{ element.amount }}
          </span>

          <span *ngIf="actionHistoryEnum.SELL === element.action" class="is-sell">
            - {{ element.filled }}
          </span>

          <span *ngIf="actionHistoryEnum.BUY === element.action" class="is-buy">
            + {{ element.total / element.price }}
          </span>

          <span *ngIf="actionHistoryEnum.RECEIVE === element.action" class="is-buy">
            + {{ element.amount }} USD
          </span>

          {{ tokenDetails.symbol }}
        </td>
      </ng-container>

      <ng-container matColumnDef="percentageResult">
        <th mat-header-cell *matHeaderCellDef> X result </th>
        <td mat-cell *matCellDef="let element">
          <ng-container *ngIf="actionHistoryEnum.SELL === element.action">
            {{ (element.price / element.averagePrice).toFixed(1) }} x
          </ng-container>

          <ng-container *ngIf="actionHistoryEnum.SELL !== element.action">
            -
          </ng-container>
        </td>
      </ng-container>

      <ng-container matColumnDef="currencyResult">
        <th mat-header-cell *matHeaderCellDef> Currency result </th>
        <td mat-cell *matCellDef="let element">
          {{ element.currencyResult }} USD
        </td>
      </ng-container>

      <ng-container matColumnDef="totalQuantity">
        <th mat-header-cell *matHeaderCellDef> Total quantity </th>
        <td mat-cell *matCellDef="let element">
          {{ element.totalQuantity }} {{ tokenDetails.symbol }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>

  <div class="im-footer">
    <div>
      <span> Total spent currency: </span>
      <span> {{ totalSpendCurrency | currency: 'USD': 'symbol': '1.0-0' }} </span>
    </div>

    <div>
      <span> Total earned currency: </span>
      <span> {{ totalEarnedCurrency | currency: 'USD': 'symbol': '1.2-2' }} </span>
    </div>

    <!-- <div>
      <span> Currency difference: </span>
      <span> {{ statistic.currencyDifference | currency: 'USD': 'symbol': '1.0-0' }} </span>
    </div> -->

    <div>
      <span> Percentage difference: </span>
      <span>
        {{ (totalEarnedCurrency / totalSpendCurrency).toFixed(1) }} x
      </span>
    </div>
  </div>
</div>